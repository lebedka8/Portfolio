<div style="border-radius: 15px; border: 3px solid indigo; padding: 15px;">
<b>–ü—Ä–∏–≤–µ—Ç, –ö–∞—Ä–∏–Ω–∞!</b>

–ú–µ–Ω—è –∑–æ–≤—É—Ç –í–∞–¥–∏–º –õ–µ–ø—à–∏–Ω, –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–µ–Ω–∏–µ –Ω–∞ ¬´—Ç—ã¬ª, –Ω–æ –µ—Å–ª–∏ —Ç–µ–±–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ –Ω–∞ ¬´–í—ã¬ª, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–æ–±—â–∏ –º–Ω–µ –æ–± —ç—Ç–æ–º. 

–ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö. –¢–æ–±–æ–π –ø—Ä–æ–¥–µ–ª–∞–Ω–∞ –±–æ–ª—å—à–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º, –¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –µ–≥–æ –µ—â–µ –ª—É—á—à–µ. –ù–∏–∂–µ —Ç—ã –Ω–∞–π–¥–µ—à—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª:<br>
- <b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.</b>
- –£ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–ø–∏—Å–∫–∏ <b>V2, V3</b> –∏ —Ç.–¥., –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏. 
   
–í —Ç–µ—Ç—Ä–∞–¥–∫–µ —Ç—ã –º–æ–∂–µ—à—å –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å 3 –≤–∏–¥–∞ –º–æ–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:
    
<div class="alert alert-danger">
    <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–∞–∫–æ–≥–æ —Ü–≤–µ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –±–µ–∑ –∏—Ö –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç.
</div>
    
    
<div class="alert alert-warning">
    <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–ù–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–∞–∫–æ–≥–æ —Ü–≤–µ—Ç–∞ –Ω—É–∂–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ. –†–µ–∫–æ–º–µ–Ω–¥—É—é —É—á–µ—Å—Ç—å –∏—Ö –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π.
</div>
    
    
<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–¢–∞–∫ –æ—Ç–º–µ—á–µ–Ω—ã —É–¥–∞—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ–¥—Ö–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
</div>
    
–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º. –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤–æ—Ç —Ç–∞–∫:

<div class="alert alert-info">
<b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b>

–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π, –í–∞–¥–∏–º!–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –º–æ–µ–π —Ä–∞–±–æ—Ç–µ.
</div>


–í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ.
</div>

# –ê–Ω–∞–ª–∏–∑ –ê/–í —Ç–µ—Å—Ç–∞ –∫—Ä—É–ø–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞

***
*–í –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –∫—Ä—É–ø–Ω–æ–≥–æ –∏–Ω–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞. –ê —Ç–∞–∫–∂–µ —Å–ø–∏—Å–æ–∫ –≥–∏–ø–æ—Ç–µ–∑ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≤—ã—Ä—É—á–∫–∏, –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –æ—Ç–¥–µ–ª–æ–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.*

***–¶–µ–ª—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è*** *- –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–∏–ø–æ—Ç–µ–∑—ã, –∑–∞–ø—É—Å—Ç–∏—Ç—åA/B-—Ç–µ—Å—Ç –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.*

***–•–æ–¥ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:***

***1.*** *–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –≥–∏–ø–æ—Ç–µ–∑ –º–µ—Ç–æ–¥–∞–º–∏ ICE –∏ RICE, —Å—Ä–∞–≤–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π*

***2.*** *–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö*

***3.*** *–ê–Ω–∞–ª–∏–∑ –ê/–ë —Ç–µ—Å—Ç–∞*

***3.*** *–í—ã–≤–æ–¥*

***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ!
</div>

## –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –≥–∏–ø–æ—Ç–µ–∑


```python
import pandas as pd                                                                            # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É pandas
import matplotlib.pyplot as plt                                                            # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É matplotlib
import datetime as dt                                                                 # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏
import numpy as np                                                                              # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É numpy
from scipy import stats as st                                                                  # –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É scipy
import scipy.stats as stats
```


```python
try:                                                                                                      # –æ—Ç–∫—Ä—ã–≤–∞–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
    hypotheses = pd.read_csv('/datasets/hypothesis.csv')                                    
except: 
    hypotheses = pd.read_csv('https://code.s3.yandex.net/datasets/hypothesis.csv')
pd.set_option('display.max_colwidth',None)                                #–ø—Ä–∏–≤–µ–¥–µ–º –∫ –≤–∏–¥—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ—Ñ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
hypotheses.columns = map(str.lower, hypotheses.columns)
hypotheses.head()                                                                          # –≤—ã–≤–µ–¥–µ–º –ø–µ—Ä–≤—ã–µ –ø—è—Ç—å —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hypothesis</th>
      <th>reach</th>
      <th>impact</th>
      <th>confidence</th>
      <th>efforts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–∞ 30% –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>3</td>
      <td>10</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É –¥–æ—Å—Ç–∞–≤–∫–∏, —á—Ç–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–∞</td>
      <td>8</td>
      <td>3</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–π–¥—É—Ç –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä</td>
      <td>8</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ú–æ–ª–æ–¥–µ—Ü —á—Ç–æ –≤—ã–≤–µ–ª–∞ —Å—Ç–æ–ª–±–µ—Ü —Å –≥–∏–ø–æ—Ç–µ–∑–∞–º–∏ —Ü–µ–ª–∏–∫–æ–º!
</div>


```python
hypotheses['ICE'] = round(((hypotheses['impact']*hypotheses['confidence'])/ hypotheses['efforts']),1)   # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ä—Ç ICE 
hypotheses[['hypothesis', 'ICE']].sort_values(by='ICE', ascending = False)                   # –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ —É–±—ã–≤–∞–Ω–∏—é
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hypothesis</th>
      <th>ICE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–∫—Ü–∏—é, –¥–∞—é—â—É—é —Å–∫–∏–¥–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –≤ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>0</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–∞ 30% –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>13.3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–∞–∑—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è email-—Ä–∞—Å—Å—ã–ª–æ–∫</td>
      <td>11.2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±–∞–Ω–Ω–µ—Ä—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–∫—Ü–∏—è–º–∏ –∏ —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞–º–∏, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–∞</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É –¥–æ—Å—Ç–∞–≤–∫–∏, —á—Ç–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ –º–∞–≥–∞–∑–∏–Ω–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>1.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–π–¥—É—Ç –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä</td>
      <td>1.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



<div class="alert alert-warning">
    <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–†–µ–∫–æ–º–µ–Ω–¥—É—é –æ–∫—Ä—É–≥–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ICE –¥–æ 1 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.
</div>

<div class="alert alert-info">
–ò—Å–ø—Ä–∞–≤–∏–ª–∞
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

üëç
</div>


```python
#—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ä—Ç RICE –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ –≥–∏–ø–æ—Ç–µ–∑
hypotheses['RICE'] = (hypotheses['impact']*hypotheses['confidence']*hypotheses['reach'])/ hypotheses['efforts']
hypotheses[['hypothesis', 'RICE']].sort_values(by='RICE', ascending = False)                # –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ —É–±—ã–≤–∞–Ω–∏—é
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hypothesis</th>
      <th>RICE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–∞–∑—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è email-—Ä–∞—Å—Å—ã–ª–æ–∫</td>
      <td>112.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–∞</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–∞ 30% –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±–∞–Ω–Ω–µ—Ä—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–∫—Ü–∏—è–º–∏ –∏ —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞–º–∏, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–∫—Ü–∏—é, –¥–∞—é—â—É—é —Å–∫–∏–¥–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –≤ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–π–¥—É—Ç –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É –¥–æ—Å—Ç–∞–≤–∫–∏, —á—Ç–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ –º–∞–≥–∞–∑–∏–Ω–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#–≤—ã–≤–µ–¥–µ–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ RICE –∏ ICE –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
hypotheses[['hypothesis', 'RICE', 'ICE']].sort_values(by='RICE', ascending = False)      
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hypothesis</th>
      <th>RICE</th>
      <th>ICE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–∞–∑—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è email-—Ä–∞—Å—Å—ã–ª–æ–∫</td>
      <td>112.0</td>
      <td>11.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–∞</td>
      <td>56.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–∞ 30% –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>40.0</td>
      <td>13.3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±–∞–Ω–Ω–µ—Ä—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–∫—Ü–∏—è–º–∏ –∏ —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞–º–∏, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é</td>
      <td>40.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–∫—Ü–∏—é, –¥–∞—é—â—É—é —Å–∫–∏–¥–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –≤ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è</td>
      <td>16.2</td>
      <td>16.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é, —Ç.–∫. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–π–¥—É—Ç –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä</td>
      <td>9.0</td>
      <td>1.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É –¥–æ—Å—Ç–∞–≤–∫–∏, —á—Ç–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ –º–∞–≥–∞–∑–∏–Ω–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</td>
      <td>4.0</td>
      <td>1.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>–ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



<div class="alert alert-warning">
  <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–î–∞–≤–∞–π –≤—ã–≤–µ–¥–µ–º –∑–¥–µ—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ RICE –∏ ICE –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.
  </div>

<div class="alert alert-info">
–î–æ–±–∞–≤–∏–ª–∞
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–°—É–ø–µ—Ä
</div>

***
***–í—ã–≤–æ–¥:*** *–ü—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–µ—Ç–æ–¥–∞ ICE –Ω–∞ –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç–∞—Ö –æ–∫–∞–∑–∞–ª–∏—Å—å –≥–∏–ø–æ—Ç–µ–∑—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ 8, 0 –∏ 7 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ –ø—Ä–∏–æ—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ RICE –Ω–∞ –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç–∞—Ö –æ–∫–∞–∑–∞–ª–∏—Å—å –≥–∏–ø–æ—Ç–µ–∑—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ 7, 2 –∏ 0. –ú—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–º–µ–Ω—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –≥–∏–ø–æ—Ç–µ–∑, —Ç–∞–∫ –∫–∞–∫ –≤–æ –≤—Ç–æ—Ä–æ–º –º–µ—Ç–æ–¥–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä reach ‚Äî –æ—Ö–≤–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–≤–ª–∏—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í—Å–µ –≤–µ—Ä–Ω–æ, –¥–µ–ª–æ –≤ –æ—Ö–≤–∞—Ç–µ!
</div>

## –ü–æ–ª—É—á–µ–Ω–∏–µ  –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ 
try:
    orders = pd.read_csv('/datasets/orders.csv')
except:
    orders = pd.read_csv('https://code.s3.yandex.net/datasets/orders.csv')

orders.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>transactionId</th>
      <th>visitorId</th>
      <th>date</th>
      <th>revenue</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3667963787</td>
      <td>3312258926</td>
      <td>2019-08-15</td>
      <td>1650</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2804400009</td>
      <td>3642806036</td>
      <td>2019-08-15</td>
      <td>730</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2961555356</td>
      <td>4069496402</td>
      <td>2019-08-15</td>
      <td>400</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3797467345</td>
      <td>1196621759</td>
      <td>2019-08-15</td>
      <td>9759</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2282983706</td>
      <td>2322279887</td>
      <td>2019-08-15</td>
      <td>2308</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
try:
    visitors = pd.read_csv('/datasets/visitors.csv')
except:
    visitors = pd.read_csv('https://code.s3.yandex.net/datasets/visitors.csv')

visitors.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>group</th>
      <th>visitors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>A</td>
      <td>719</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-02</td>
      <td>A</td>
      <td>619</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-03</td>
      <td>A</td>
      <td>507</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-04</td>
      <td>A</td>
      <td>717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-05</td>
      <td>A</td>
      <td>756</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö
df = [orders,visitors]
for i in df:
    print(i.info())
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1197 entries, 0 to 1196
    Data columns (total 5 columns):
     #   Column         Non-Null Count  Dtype 
    ---  ------         --------------  ----- 
     0   transactionId  1197 non-null   int64 
     1   visitorId      1197 non-null   int64 
     2   date           1197 non-null   object
     3   revenue        1197 non-null   int64 
     4   group          1197 non-null   object
    dtypes: int64(3), object(2)
    memory usage: 46.9+ KB
    None
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 62 entries, 0 to 61
    Data columns (total 3 columns):
     #   Column    Non-Null Count  Dtype 
    ---  ------    --------------  ----- 
     0   date      62 non-null     object
     1   group     62 non-null     object
     2   visitors  62 non-null     int64 
    dtypes: int64(1), object(2)
    memory usage: 1.6+ KB
    None



```python
# –ø—Ä–∏–≤–µ–¥–µ–º –¥–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç–æ–π –∫ –Ω—É–∂–Ω–æ–º—É —Ç–∏–ø—É
orders['date'] = orders['date'].map(lambda x: dt.datetime.strptime(x, '%Y-%m-%d'))
visitors['date'] = visitors['date'].map(lambda x: dt.datetime.strptime(x, '%Y-%m-%d'))
```


```python
#–ø—Ä–∏–≤–µ–¥–µ–º –Ω–∞–∑–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
orders.columns = orders.columns.str.lower()
```


```python
# –ø—Ä–∏–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –∫ —Ñ–æ—Ä–º–∞—Ç—É snake_case
orders = orders.rename(columns={'transactionid':'transaction_id','visitorid':'visitor_id'})
```


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
for i in df:
    print(i.isna().sum())   
```

    transactionid    0
    visitorid        0
    date             0
    revenue          0
    group            0
    dtype: int64
    date        0
    group       0
    visitors    0
    dtype: int64



```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
for i in df:
    print (i.duplicated().sum())
```

    0
    0



```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ 
group_a = visitors.query('group == "A"')['visitors'].sum() 
group_b = visitors.query('group == "B"')['visitors'].sum() 
 
(group_b/(group_a+group_b))*100 - (group_a/(group_a+group_b))*100
```




    0.4780622543291173



–û—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –º–µ–Ω–µ–µ 1%. –ì—Ä—É–ø–ø—ã –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å —Ä–∞–≤–Ω–æ—Ü–µ–Ω–Ω—ã–º–∏. –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤ –∫–∞–∂–¥—É—é –≥—Ä—É–ø–ø—É –ø–æ–ø–∞–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.


```python
# –Ω–∞–π–¥–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
unique_id_list_A = orders.query('group == "A"')['visitor_id'].unique().tolist()
unique_id_list_B = orders.query('group == "B"')['visitor_id'].unique().tolist()
unique_id_dublicated = []

# –ø—Ä–æ–≤–µ—Ä–∏–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö
for x in unique_id_list_A:
    if x in unique_id_list_B:
        unique_id_dublicated.append(x)
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã', len(unique_id_dublicated))
```

    –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã 58



```python
# –ü–æ—Å—á–∏—Ç–∞–µ–º –¥–æ–ª—é —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö
len(unique_id_dublicated)/len(orders['visitor_id'].unique())*100
```




    5.625606207565471



–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –ø–æ–ø–∞–ª–∏ —Å—Ä–∞–∑—É –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã. –ò—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ (5,6%), –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ —Ç–µ—Å—Ç–µ, —Ç–∞–∫ –∫–∞–∫ –µ—Å–ª–∏ –º—ã —É–¥–∞–ª–∏–º –∏—Ö, —ç—Ç–æ —Å–∫–∞–∂–µ—Ç—Å—è –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ä–∞—Å—á–µ—Ç–∞—Ö. –¢–µ–º –±–æ–ª–µ–µ, —á—Ç–æ —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–π –∏–∑ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü—ã –º—ã –Ω–µ —Å–º–æ–∂–µ–º, –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞–π—Ç–∏ –∏—Ö id.

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í—Å–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ!
</div>


```python
# –≤—ã—è—Å–Ω–∏–º –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∞
visitors['date'].min()
```




    Timestamp('2019-08-01 00:00:00')




```python
# –≤—ã—è—Å–Ω–∏–º –¥–∞—Ç—É –∫–æ–Ω—Ü–∞ —Ç–µ—Å—Ç–∞
visitors['date'].max()
```




    Timestamp('2019-08-31 00:00:00')




```python
# –ø–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –¥–ª–∏–ª—Å—è —Ç–µ—Å—Ç
print(visitors['date'].max() - visitors['date'].min())
```

    30 days 00:00:00



```python
# –≤—ã–≤–µ–¥–µ–º –Ω–∞ —ç–∫—Ä–∞–Ω –ø–µ—Ä–≤—ã–µ –ø—è—Ç—å —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü
orders.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>transaction_id</th>
      <th>visitor_id</th>
      <th>date</th>
      <th>revenue</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3667963787</td>
      <td>3312258926</td>
      <td>2019-08-15</td>
      <td>1650</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2804400009</td>
      <td>3642806036</td>
      <td>2019-08-15</td>
      <td>730</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2961555356</td>
      <td>4069496402</td>
      <td>2019-08-15</td>
      <td>400</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3797467345</td>
      <td>1196621759</td>
      <td>2019-08-15</td>
      <td>9759</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2282983706</td>
      <td>2322279887</td>
      <td>2019-08-15</td>
      <td>2308</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
visitors.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>group</th>
      <th>visitors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>A</td>
      <td>719</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-02</td>
      <td>A</td>
      <td>619</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-03</td>
      <td>A</td>
      <td>507</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-04</td>
      <td>A</td>
      <td>717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-05</td>
      <td>A</td>
      <td>756</td>
    </tr>
  </tbody>
</table>
</div>



 ***
***–í—ã–≤–æ–¥:*** *–í –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö –ê/–í —Ç–µ—Å—Ç–æ–≤ –∫—Ä—É–ø–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç - –º–∞–≥–∞–∑–∏–Ω–∞.* 

***–¢–∞–±–ª–∏—Ü–∞ orders:***
* transaction_id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞;
* visitor_id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–≤–µ—Ä—à–∏–≤—à–µ–≥–æ –∑–∞–∫–∞–∑;
* date ‚Äî –¥–∞—Ç–∞, –∫–æ–≥–¥–∞ –±—ã–ª —Å–æ–≤–µ—Ä—à—ë–Ω –∑–∞–∫–∞–∑;
* revenue ‚Äî –≤—ã—Ä—É—á–∫–∞ –∑–∞–∫–∞–∑–∞;
* group ‚Äî –≥—Ä—É–ø–ø–∞ A/B-—Ç–µ—Å—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ø–∞–ª –∑–∞–∫–∞–∑.

***–¢–∞–±–ª–∏—Ü–∞ visitors:***

* date ‚Äî –¥–∞—Ç–∞;
* group ‚Äî –≥—Ä—É–ø–ø–∞ A/B-—Ç–µ—Å—Ç–∞;
* visitors ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ A/B-—Ç–µ—Å—Ç–∞

***–ü–æ –∏—Ç–æ–≥—É –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:***
* –ü—Ä–∏–≤–µ–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∫ –Ω—É–∂–Ω–æ–º—É –≤–∏–¥—É.
* –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã—Ö –æ –¥–∞—Ç–∞—Ö.
* –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –ø—Ä–æ–ø—É—Å–∫–∏.
* –í—ã—Å–Ω–∏–ª–∏, —á—Ç–æ —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏–ª 30 –¥–Ω–µ–π. –° 1 –ø–æ 31 –∞–≤–≥—É—Å—Ç–∞ 2019 –≥–æ–¥–∞.
* –ü–æ—Å—á–∏—Ç–∞–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö. –†–∞–∑–ª–∏—á–∏—è —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ –±–æ–ª–µ–µ, —á–µ–º 1%.
* –û–±–Ω–∞—Ä—É–∂–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã, –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 5,6% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –†–µ—à–∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —Å–º–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –¥–≤—É—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤. 
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!!
</div>

##  –ê–Ω–∞–ª–∏–∑ A/B-—Ç–µ—Å—Ç–∞

### –ì—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º

–ß—Ç–æ–±—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–æ—Å—Ç–∞–≤–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –∫—É–º–º—É–ª—è—Ç–∏–≤–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. 


```python
# —Å–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä –∑–Ω–∞—á–µ–Ω–∏–π –¥–∞—Ç –∏ –≥—Ä—É–ø–ø —Ç–µ—Å—Ç–∞
datesGroups  = orders[['date', 'group']].drop_duplicates()

# –ø–æ–ª—É—á–∞–µ–º –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ –¥–Ω—è–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö
ordersAggregated = datesGroups.apply(lambda x: orders[np.logical_and(orders['date'] <= x['date'],\
                                                                     orders['group'] == x['group'])]\
                                     .agg({'date' : 'max', 'group' : 'max', 'transaction_id' : 'nunique', \
                                           'visitor_id' : 'nunique', 'revenue' : 'sum'}), axis=1)\
                                     .sort_values(by=['date','group'])

#–ø–æ–ª—É—á–∏–º –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ –¥–Ω—è–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞:
visitorsAggregated = datesGroups.apply(lambda x: visitors[np.logical_and(visitors['date'] <= x['date'],\
                                                                         visitors['group'] == x['group'])]\
                                       .agg({'date' : 'max', 'group' : 'max', 'visitors' : 'sum'}), axis=1)\
                                       .sort_values(by=['date','group'])

# –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –µ–µ —Å—Ç–æ–ª–±—Ü–∞–º –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
cumulativeData = ordersAggregated.merge(visitorsAggregated, left_on=['date', 'group'], right_on=['date', 'group'])
cumulativeData.columns = ['date', 'group', 'orders', 'buyers', 'revenue', 'visitors']

cumulativeData.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>group</th>
      <th>orders</th>
      <th>buyers</th>
      <th>revenue</th>
      <th>visitors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>A</td>
      <td>24</td>
      <td>20</td>
      <td>148579</td>
      <td>719</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-01</td>
      <td>B</td>
      <td>21</td>
      <td>20</td>
      <td>101217</td>
      <td>713</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-02</td>
      <td>A</td>
      <td>44</td>
      <td>38</td>
      <td>242401</td>
      <td>1338</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-02</td>
      <td>B</td>
      <td>45</td>
      <td>43</td>
      <td>266748</td>
      <td>1294</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-03</td>
      <td>A</td>
      <td>68</td>
      <td>62</td>
      <td>354874</td>
      <td>1845</td>
    </tr>
  </tbody>
</table>
</div>



–ü–µ—Ä–µ–¥ –Ω–∞–º–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ —Å—Ç–æ–ª–±—Ü–∞–º–∏:
* date ‚Äî –¥–∞—Ç–∞;
* group ‚Äî –≥—Ä—É–ø–ø–∞ A/B-—Ç–µ—Å—Ç–∞ (A –∏–ª–∏ B);
* orders ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ;
* buyers ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∑–∞–∫–∞–∑, –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ;
* revenue ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ (—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫);
* visitors ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ.


```python
# –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤ –∏ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–æ–π –ø–æ –¥–Ω—è–º –≤ –≥—Ä—É–ø–ø–µ –ê
cumulativeRevenueA = cumulativeData[cumulativeData['group']=='A'][['date','revenue', 'orders']]
cumulativeRevenueA.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>revenue</th>
      <th>orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>148579</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-02</td>
      <td>242401</td>
      <td>44</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-03</td>
      <td>354874</td>
      <td>68</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2019-08-04</td>
      <td>425699</td>
      <td>84</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2019-08-05</td>
      <td>549917</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤ –∏ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–æ–π –ø–æ –¥–Ω—è–º –≤ –≥—Ä—É–ø–ø–µ B
cumulativeRevenueB = cumulativeData[cumulativeData['group']=='B'][['date','revenue', 'orders']]
cumulativeRevenueB.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>revenue</th>
      <th>orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2019-08-01</td>
      <td>101217</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-02</td>
      <td>266748</td>
      <td>45</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-08-03</td>
      <td>380996</td>
      <td>61</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2019-08-04</td>
      <td>489567</td>
      <td>78</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2019-08-05</td>
      <td>581995</td>
      <td>101</td>
    </tr>
  </tbody>
</table>
</div>




```python
plt.rcParams ['figure.figsize'] = [12, 6]

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏ –≥—Ä—É–ø–ø—ã –ê
plt.plot(cumulativeRevenueA['date'], cumulativeRevenueA['revenue'], label='A',color = '#ff8d1a', linewidth= 3)

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏ –≥—Ä—É–ø–ø—ã B
plt.plot(cumulativeRevenueB['date'], cumulativeRevenueB['revenue'], label='B', linewidth= 3, color='#1a8cff')


plt.legend()
plt.ticklabel_format(style='plain', axis='y')
plt.title('–ì—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–í—ã—Ä—É—á–∫–∞')
plt.grid()
plt.show()
```


    
![png](output_48_0.png)
    


<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ì—Ä–∞—Ñ–∏–∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!
</div>

***
***–í—ã–≤–æ–¥:*** *–í—ã—Ä—É—á–∫–∞ –ø–æ—á—Ç–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ —Ç–µ—Å—Ç–∞. –û–¥–Ω–∞–∫–æ –≥—Ä–∞—Ñ–∏–∫ –≥—Ä—É–ø–ø—ã –í –≤ –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ —Ä–µ–∑–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞—Å—Ç–∏, –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ –≥—Ä—É–ø–ø—É –ê. –≠—Ç–æ –º–æ–∂–µ—Ç —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ –≤—Å–ø–ª–µ—Å–∫–∞—Ö —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤, –ª–∏–±–æ –æ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–∫–∞–∑–æ–≤ –≤ –≤—ã–±–æ—Ä–∫–µ.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í—ã–≤–æ–¥ –ø—Ä–∏–Ω—è—Ç!
</div>

### –ì—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º


```python
# –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º

plt.plot(cumulativeRevenueA['date'], cumulativeRevenueA['revenue']/cumulativeRevenueA['orders'],
         label='A',color = '#ff8d1a', linewidth= 3)

plt.plot(cumulativeRevenueB['date'], cumulativeRevenueB['revenue']/cumulativeRevenueB['orders'],
         label='B', linewidth= 3, color='#1a8cff')

plt.legend()
plt.title('–ì—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')
plt.grid()
plt.show()
```


    
![png](output_53_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ –≥—Ä—É–ø–ø–µ –í –∏ –∑–¥–µ—Å—å –∏–º–µ–µ—Ç —Ä–µ–∑–∫–∏–π —Å–∫–∞—á–æ–∫ –∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–µ–≤—ã—à–∞—é—Ç —Ü–∏—Ñ—Ä—ã –≥—Ä—É–ø–ø—ã –ê. –í–æ–∑–º–æ–∂–Ω–æ –ø–æ–ø–∞–ª–∏ –∫—Ä—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏—Å–∫–∞–∂–∞–µ—Ç –≤—ã–≤–æ–¥—ã. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—ã–±—Ä–æ—Å–æ–≤.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–∏–Ω—è—Ç–æ! –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –í –µ—â–µ –Ω–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è.
</div>

### –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ A


```python
# —Å–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
mergedCumulativeRevenue = cumulativeRevenueA.merge(cumulativeRevenueB, 
                                                   left_on='date', right_on='date', how='left', suffixes=['A', 'B'])
mergedCumulativeRevenue.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>revenueA</th>
      <th>ordersA</th>
      <th>revenueB</th>
      <th>ordersB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>148579</td>
      <td>24</td>
      <td>101217</td>
      <td>21</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-02</td>
      <td>242401</td>
      <td>44</td>
      <td>266748</td>
      <td>45</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-03</td>
      <td>354874</td>
      <td>68</td>
      <td>380996</td>
      <td>61</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-04</td>
      <td>425699</td>
      <td>84</td>
      <td>489567</td>
      <td>78</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-05</td>
      <td>549917</td>
      <td>109</td>
      <td>581995</td>
      <td>101</td>
    </tr>
  </tbody>
</table>
</div>




```python
# c—Ç—Ä–æ–∏–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤
plt.plot(mergedCumulativeRevenue['date'],(mergedCumulativeRevenue['revenueB']/mergedCumulativeRevenue['ordersB'])\
         /(mergedCumulativeRevenue['revenueA']/mergedCumulativeRevenue['ordersA'])-1,\
        color = '#1a8cff', linewidth= 3)

# –¥–æ–±–∞–≤–ª—è–µ–º –æ—Å—å X
plt.axhline(y=0, color='black', linestyle='--')
plt.axhline(y=0.26, color='grey', linestyle='--')
plt.title('–ì—Ä–∞—Ñ–∏–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ A')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')

plt.show()
```


    
![png](output_58_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–ù–∞ –≥—Ä–∞—Ñ–∏–∫–∏ —è—Ä–∫–æ –≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞  –≥—Ä—É–ø–ø —Ä–µ–∑–∫–æ –º–µ–Ω—è–ª–∏—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –í–∏–¥–∏–º–æ –∫–∞–∫ —Ä–∞–∑ –≤ —ç—Ç–∏ –¥–∞—Ç—ã –∏ –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã –∞–Ω–æ–º–∞–ª—å–Ω–æ –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –≤ –≥—Ä—É–ø–ø–µ –í. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≤—ã–±—Ä–æ—Å—ã –≤ –¥–∞–Ω–Ω—ã—Ö.*
****

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–°–æ–≥–ª–∞—Å–µ–Ω!
</div>

### –ì—Ä–∞—Ñ–∏–∫ –≥—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –ø–æ –≥—Ä—É–ø–ø–∞–º


```python
# —Å—á–∏—Ç–∞–µ–º –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è
cumulativeData['ratio'] = cumulativeData['orders']/cumulativeData['visitors']
cumulativeData.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>group</th>
      <th>orders</th>
      <th>buyers</th>
      <th>revenue</th>
      <th>visitors</th>
      <th>ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>A</td>
      <td>24</td>
      <td>20</td>
      <td>148579</td>
      <td>719</td>
      <td>0.033380</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-01</td>
      <td>B</td>
      <td>21</td>
      <td>20</td>
      <td>101217</td>
      <td>713</td>
      <td>0.029453</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-02</td>
      <td>A</td>
      <td>44</td>
      <td>38</td>
      <td>242401</td>
      <td>1338</td>
      <td>0.032885</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-02</td>
      <td>B</td>
      <td>45</td>
      <td>43</td>
      <td>266748</td>
      <td>1294</td>
      <td>0.034776</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-03</td>
      <td>A</td>
      <td>68</td>
      <td>62</td>
      <td>354874</td>
      <td>1845</td>
      <td>0.036856</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –æ—Ç–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ A
cumulativeDataA = cumulativeData[cumulativeData['group']=='A']

# –æ—Ç–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ B
cumulativeDataB = cumulativeData[cumulativeData['group']=='B']

# —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏
plt.plot(cumulativeDataA['date'], cumulativeDataA['ratio'], label='A', color = '#ff8d1a', linewidth= 3)
plt.plot(cumulativeDataB['date'], cumulativeDataB['ratio'], label='B', linewidth= 3, color='#1a8cff')

plt.legend()
plt.grid()
plt.title('–ì—Ä–∞—Ñ–∏–∫ –≥—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –ø–æ –≥—Ä—É–ø–ø–∞–º')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')

plt.show()
#plt.axis(["2019-08-01", "2019-08-31", 0, 0.040]) - –Ω–µ –º–æ–≥—É –¥–∞–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å
# –ø–æ—è–≤–ª—è–µ—Ç—Å—è –µ—â–µ –æ–¥–Ω–∞ –ø—É—Å—Ç–∞—è —Ä–∞–º–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞.
```


    
![png](output_63_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–í –Ω–∞—á–∞–ª–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –≥—Ä—É–ø–ø –º–µ–Ω—è–ª–∏ –ª–∏–¥–µ—Ä—Å–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏, –Ω–æ –ø–æ—Å–ª–µ 5 –∞–≤–≥—É—Å—Ç–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≥—Ä—É–ø–ø—ã –í –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ —Ä–∞—Å—Ç–∏, –∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≥—Ä—É–ø–ø—ã –ê - –ø–∞–¥–∞—Ç—å. –í –∏—Ç–æ–≥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã –ê –æ–∫–∞–∑–∞–ª–æ—Å—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 0,029-0,030% . –ö–æ–ª–∏—á–µ—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã –í –∑–∞–∫—Ä–µ–ø–∏–ª–∞—Å—å –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π 0,033-0,034%.*
***

<div class="alert alert-danger">
    <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–í—ã—á–∏—Å–ª–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç.–∫. —É –Ω–∞—Å –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö (–≤ —Ç–∞–±–ª–∏—Ü–µ visitors –Ω–µ—Ç id –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π). –ü–æ—ç—Ç–æ–º—É –≤ –∑–∞–¥–∞–Ω–∏–∏ –≥–æ–≤–æ—Ä–∏—Ç—Å—è –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤, –∞ –Ω–µ –æ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏. –î–∞–≤–∞–π –∑–∞–º–µ–Ω–∏–º —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É "–∫–æ–Ω–≤–µ—Ä—Å–∏—è" –Ω–∞ "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤" –≤ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –∏ –≤—ã–≤–æ–¥–∞—Ö –≤ —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –∏ –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ. 
</div>

<div class="alert alert-info">
–ó–∞–º–µ–Ω–∏–∞–ª–∞
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

### –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ A


```python
mergedCumulativeratios = cumulativeDataA[['date','ratio']].merge(cumulativeDataB[['date','ratio']],
                                                                           left_on='date', 
                                                                           right_on='date', how='left', suffixes=['A', 'B'])
mergedCumulativeratios.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>ratioA</th>
      <th>ratioB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-08-01</td>
      <td>0.033380</td>
      <td>0.029453</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08-02</td>
      <td>0.032885</td>
      <td>0.034776</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-08-03</td>
      <td>0.036856</td>
      <td>0.033833</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-04</td>
      <td>0.032787</td>
      <td>0.030315</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-08-05</td>
      <td>0.032851</td>
      <td>0.030793</td>
    </tr>
  </tbody>
</table>
</div>




```python
plt.plot(mergedCumulativeratios['date'], 
         mergedCumulativeratios['ratioB']/mergedCumulativeratios['ratioA']-1,
        linewidth= 3, color='#1a8cff')


plt.axhline(y=0, color='black', linestyle='--')
plt.axhline(y=0.14, color='grey', linestyle='--') 
plt.title('–ì—Ä–∞—Ñ–∏–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ A')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('C—Ä–µ–¥–Ω–µ–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è')
plt.show()
```


    
![png](output_70_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Ç–µ—Å—Ç–∞ –±—ã–ª–æ –Ω–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ  –≤ –≥—Ä—É–ø–ø–∞—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞.–ü–æ—Å–ª–µ 5 –∞–≤–≥—É—Å—Ç–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –≤ –≥—Ä—É–ø–ø–µ –í —Ä–µ–∑–∫–æ –≤—ã—Ä–æ—Å, –∞ –≤ –≥—Ä—É–ø–ø–µ –ê —É–ø–∞–ª. –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –ø–æ—Å–ª–µ —ç—Ç–æ–π –¥–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–æ–ª—å–∑—É –≥—Ä—É–ø–ø—ã –í –∏ –∫ –∫–æ–Ω—Ü—É —Ç–µ—Å—Ç–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —É—Ä–æ–≤–Ω—è 0,15 %.* 
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–¢–µ–ø–µ—Ä—å –≤—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!
</div>

###  –¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º


```python
# –ø–æ–¥—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

ordersByUsers = (
    orders.groupby('visitor_id', as_index=False)
    .agg({'transaction_id': 'nunique'})
)

ordersByUsers.columns = ['user_id', 'orders']

ordersByUsers.sort_values(by='orders', ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1023</th>
      <td>4256040402</td>
      <td>11</td>
    </tr>
    <tr>
      <th>591</th>
      <td>2458001652</td>
      <td>11</td>
    </tr>
    <tr>
      <th>569</th>
      <td>2378935119</td>
      <td>9</td>
    </tr>
    <tr>
      <th>487</th>
      <td>2038680547</td>
      <td>8</td>
    </tr>
    <tr>
      <th>44</th>
      <td>199603092</td>
      <td>5</td>
    </tr>
    <tr>
      <th>744</th>
      <td>3062433592</td>
      <td>5</td>
    </tr>
    <tr>
      <th>55</th>
      <td>237748145</td>
      <td>5</td>
    </tr>
    <tr>
      <th>917</th>
      <td>3803269165</td>
      <td>5</td>
    </tr>
    <tr>
      <th>299</th>
      <td>1230306981</td>
      <td>5</td>
    </tr>
    <tr>
      <th>897</th>
      <td>3717692402</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–æ—á–µ—á–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

x_values = pd.Series(range(0,len(ordersByUsers)))
plt.scatter(x_values, ordersByUsers['orders'], alpha = 0.5, color='#1a8cff') 

plt.title('–¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º')
plt.xlabel('–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏')
plt.ylabel('–ó–∞–∫–∞–∑—ã')
plt.grid()
plt.show()
```


    
![png](output_75_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–ü–æ –≥—Ä–∞—Ñ–∏–∫—É –≤–∏–¥–Ω–æ, —á—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –æ—Ç 1-2 –∑–∞–∫–∞–∑–∞. –ù–æ —Ç–∞–∫–∂–µ –º—ã –Ω–∞—à–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é –æ—Ç 5 –¥–æ 11 –ø–æ–∫—É–ø–æ–∫. –î–æ–ª—è –∏—Ö –Ω–µ—è—Å–Ω–∞, –ø—Ä–æ–¥–æ–ª–∂–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –≤—ã—è—Å–Ω–∏—Ç—å –∫–∞–∫–æ–≤ –∏—Ö –ø—Ä–æ—Ü–µ–Ω—Ç.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ì—Ä–∞—Ñ–∏–∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω –≤–µ—Ä–Ω–æ, –≤—ã–≤–æ–¥ –ª–æ–≥–∏—á–µ–Ω.
</div>

### –ü–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è


```python
# –ø–æ—Å—á–∏—Ç–∞–µ–º 95-–π –∏ 99-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤
print(np.percentile(ordersByUsers['orders'], [95, 99]))
```

    [2. 4.]


***
***–í—ã–≤–æ–¥:*** *–ù–µ –±–æ–ª–µ–µ 5% –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏–Ω—Ç—Ä–µ–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –¥–µ–ª–∞–ª–∏ –±–æ–ª–µ–µ –¥–≤—É—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –Ω–µ –±–æ–ª–µ–µ 1% –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –±–æ–ª–µ–µ 4-—Ö –∑–∞–∫–∞–∑–æ–≤. –í—ã–±–µ—Ä–µ–º 4 –∑–∞–∫–∞–∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

### –¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –∑–∞–∫–∞–∑–æ–≤ 


```python
# –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –¢–û–ü-10 –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤
orders.sort_values(by='revenue', ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>transaction_id</th>
      <th>visitor_id</th>
      <th>date</th>
      <th>revenue</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>425</th>
      <td>590470918</td>
      <td>1920142716</td>
      <td>2019-08-19</td>
      <td>1294500</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1196</th>
      <td>3936777065</td>
      <td>2108080724</td>
      <td>2019-08-15</td>
      <td>202740</td>
      <td>B</td>
    </tr>
    <tr>
      <th>858</th>
      <td>192721366</td>
      <td>1316129916</td>
      <td>2019-08-27</td>
      <td>93940</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1136</th>
      <td>666610489</td>
      <td>1307669133</td>
      <td>2019-08-13</td>
      <td>92550</td>
      <td>A</td>
    </tr>
    <tr>
      <th>744</th>
      <td>3668308183</td>
      <td>888512513</td>
      <td>2019-08-27</td>
      <td>86620</td>
      <td>B</td>
    </tr>
    <tr>
      <th>682</th>
      <td>1216533772</td>
      <td>4266935830</td>
      <td>2019-08-29</td>
      <td>78990</td>
      <td>B</td>
    </tr>
    <tr>
      <th>662</th>
      <td>1811671147</td>
      <td>4266935830</td>
      <td>2019-08-29</td>
      <td>78990</td>
      <td>A</td>
    </tr>
    <tr>
      <th>743</th>
      <td>3603576309</td>
      <td>4133034833</td>
      <td>2019-08-09</td>
      <td>67990</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>1348774318</td>
      <td>1164614297</td>
      <td>2019-08-12</td>
      <td>66350</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1099</th>
      <td>316924019</td>
      <td>148427295</td>
      <td>2019-08-12</td>
      <td>65710</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤
x_values = pd.Series(range(0,len(orders['revenue'])))
plt.scatter(x_values, orders['revenue'], alpha = 0.5, color='#1a8cff') 

plt.title('–¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –∑–∞–∫–∞–∑–æ–≤')
plt.xlabel('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏')
plt.ylabel('–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤')
plt.ticklabel_format(style='plain', axis='y')
plt.grid()
plt.show()
```


    
![png](output_84_0.png)
    



```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤ –±–µ–∑ –≤—ã–±—Ä–æ—Å–∞
x_values = pd.Series(range(0,len(orders['revenue'])))
plt.scatter(x_values, orders['revenue'], alpha = 0.5, color='#1a8cff') 

plt.title('–¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –∑–∞–∫–∞–∑–æ–≤')
plt.xlabel('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏')
plt.ylabel('–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤')
plt.ticklabel_format(style='plain', axis='y')
plt.ylim(0, 120000)
plt.grid()
plt.show()
```


    
![png](output_85_0.png)
    


***
***–í—ã–≤–æ–¥:*** *–ì—Ä–∞—Ñ–∏–∫ –Ω–∞–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç –ø–æ–∫—É–ø–∫–∏ —Å—É–º–º–æ–π –¥–æ 15000 —Ä—É–±–ª–µ–π. –ù–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è —Å  ID 1920142716, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–µ—Ä—à–∏–ª –ø–æ–∫—É–ø–∫—É –Ω–∞ 1294500 —Ä—É–±–ª–µ–π. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –¥–æ 20000 —Ä—É–±–ª–µ–π. –ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤ –æ—Ç 20000 –¥–æ 60000 —Ä—É–±–ª–µ–π. –ù—É–∂–Ω–æ —Ç–æ—á–Ω–æ –≤—ã—è—Å–Ω–∏—Ç—å –∫–∞–∫–æ–≤–∞ –∏—Ö –¥–æ–ª—è.*
***

<div class="alert alert-danger">
    <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–ò–∑-–∑–∞ –¥–≤—É—Ö –≤—ã–±—Ä–æ—Å–æ–≤ –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–∞–ª –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –µ—â–µ –æ–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫ –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤.
</div>

<div class="alert alert-info">
–ì—Ä–∞—Ñ–∏–∫ –¥–æ–±–∞–≤–∏–ª–∞, –≤—ã–≤–æ–¥ –¥–æ–ø–∏—Å–∞–ª–∞. –¢–∞–∫ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–µ–µ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–µ–ª–µ–π —Ç–µ–ø–µ—Ä—å –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è.
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–°–ø–∞—Å–∏–±–æ!
</div>

### –ü–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤


```python
# –ø–æ—Å—á–∏—Ç–∞–µ–º 95-–π –∏ 99-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤
print(np.percentile(orders['revenue'], [95, 99]))
```

    [28000.  58233.2]


***
***–í—ã–≤–æ–¥:*** *–ù–µ –±–æ–ª–µ–µ 5% –ø–æ–∫—É–ø–æ–∫ –≤ –∏–Ω—Ç—Ä–µ–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –±–æ–ª–µ–µ 28000 —Ä—É–±–ª–µ–π –∏ –Ω–µ –±–æ–ª–µ–µ 1% –ø–æ–∫—É–ø–æ–∫ –±–æ–ª–µ–µ 58233.2 —Ä—É–±–ª–µ–π. –í—ã–±–µ—Ä–µ–º 58000 –≥—Ä–∞–Ω–∏—Ü–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

### –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –ø–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º



–ü–æ—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º. 
–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ–º –≥–∏–ø–æ—Ç–µ–∑—ã. 
–ù—É–ª–µ–≤–∞—è: —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ—Ç. 
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è: —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å.

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ì–∏–ø–æ—Ç–µ–∑—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã!
</div>


```python
# –û–ø—Ä–µ–¥–µ–ª–∏–º –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
visitorsPerDateA = visitors.query('group= = "A"')
visitorsPerDateB = visitors.query('group= = "B"')
```

<div class="alert alert-warning">
    <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã data –≤ —Ü–µ–ª–æ–º –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ò–∑ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã –±–µ—Ä–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ visitors.
</div>

<div class="alert alert-info">
–ó–∞–º–µ–Ω–∏–∞–ª–∞ –∫–æ–¥. —Ç–∞–∫ –ø—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ )
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–°—É–ø–µ—Ä!
</div>

–°–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ordersByUsersA –∏ ordersByUsersB —Å–æ —Å—Ç–æ–ª–±—Ü–∞–º–∏ ['visitor_id', 'orders']. –í –Ω–∏—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–∑—ã–≤–∞–ª–∏ —Ö–æ—Ç—è –±—ã 1 —Ä–∞–∑, —É–∫–∞–∂–µ–º —á–∏—Å–ª–æ —Å–æ–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤. 


```python
ordersByUsersA = (
    orders[orders['group'] == 'A']
    .groupby('visitor_id', as_index=False)
    .agg({'transaction_id': pd.Series.nunique})
)
ordersByUsersA.columns = ['visitor_id', 'orders']

ordersByUsersB = (
    orders[orders['group'] == 'B']
    .groupby('visitor_id', as_index=False)
    .agg({'transaction_id': pd.Series.nunique})
)
ordersByUsersB.columns = ['visitor_id', 'orders']
```

–û–±—ä—è–≤–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ sampleA –∏ sampleB, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤. –¢–µ–º, –∫—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–∫–∞–∑–∞–ª, –±—É–¥—É—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω—É–ª–∏. 


```python
sampleA = pd.concat(
    [
        ordersByUsersA['orders'],
        pd.Series(
            0,
            index=np.arange(
                visitorsPerDateA['visitors'].sum() - len(ordersByUsersA['orders'])
            ),
            name='orders',
        ),
    ],
    axis=0,
)

sampleB = pd.concat(
    [
        ordersByUsersB['orders'],
        pd.Series(
            0,
            index=np.arange(
                visitorsPerDateB['visitors'].sum() - len(ordersByUsersB['orders'])
            ),
            name='orders',
        ),
    ],
    axis=0,
)
```

–†–∞–Ω–µ–µ –º—ã –Ω–∞–±–ª—é–¥–∞–ª–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—ã–±–æ—Ä–æ–∫ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–∏–º–µ–Ω–∏–≤ –∫—Ä–∏—Ç–µ—Ä–∏–π –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞.


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –ø–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º –≤ –≥—Ä—É–ø–ø–µ –ê
alpha = 0.05  # –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

results = st.shapiro(sampleA)
p_value = results[1]                 

print('p-–∑–Ω–∞—á–µ–Ω–∏–µ:', p_value)

if p_value < alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ')
else:
    print('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –≤—Å—ë –Ω–æ—Ä–º–∞–ª—å–Ω–æ') 
```

    p-–∑–Ω–∞—á–µ–Ω–∏–µ: 0.0
    –û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ


    /opt/conda/lib/python3.9/site-packages/scipy/stats/_morestats.py:1800: UserWarning: p-value may not be accurate for N > 5000.
      warnings.warn("p-value may not be accurate for N > 5000.")



```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º 
alpha = 0.05  # –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

results = st.shapiro(sampleB)
p_value = results[1]

print('p-–∑–Ω–∞—á–µ–Ω–∏–µ:', p_value)

if p_value < alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ')
else:
    print('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –≤—Å—ë –Ω–æ—Ä–º–∞–ª—å–Ω–æ') 
```

    p-–∑–Ω–∞—á–µ–Ω–∏–µ: 0.0
    –û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ


<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ú–æ–ª–æ–¥–µ—Ü —á—Ç–æ —Å–¥–µ–ª–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è!
</div>

–ü–æ—Å–∫–æ–ª—å–∫—É –≤ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã –∏ –æ–Ω–∏ —Å–æ—Ç–æ—è—Ç –∏–∑ –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫, –ø—Ä–∏–º–µ–Ω–∏–º –º–µ—Ç–æ–¥ st.mannwhitneyu().
–û–ø—Ä–µ–¥–µ–ª–∏–º —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ alpha = 0.05


```python
print('–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º:',"{0:.3f}".format(stats.mannwhitneyu(sampleA, sampleB)[1]))
print('–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ –ê:',"{0:.3f}".format(sampleB.mean() / sampleA.mean() - 1))
```

    –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º: 0.017
    –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B –∫ –≥—Ä—É–ø–ø–µ –ê: 0.138


<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã!
</div>

<div class="alert alert-warning">
    <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–î–∞–≤–∞–π –ø–æ–¥–ø–∏—à–µ–º —Ü–∏—Ñ—Ä—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ. –°—Ç–æ—Ä–æ–Ω–Ω–∏–π —á–µ–ª–æ–≤–µ–∫, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—è —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç, –Ω–µ –ø–æ–π–º–µ—Ç —á—Ç–æ —ç—Ç–æ –∑–∞ —Ü–∏—Ñ—Ä—ã –∏ –∫–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∏—Ö —Ç—ã –ø—Ä–∏–Ω—è–ª–∞ —Ä–µ—à–µ–Ω–∏–µ. –¢–æ –∂–µ —Å–∞–º–æ–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫.
</div>

<div class="alert alert-info">
–¶–∏—Ñ—Ä—Ñ –ø–æ–¥–ø–∏—Å–∞–ª–∞ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–°–ø–∞—Å–∏–±–æ!
</div>

***
***–í—ã–≤–æ–¥:*** *–ü–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º P-value 0,017 –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ alpha. –ú—ã –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É - —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B - 13,8%. –ü–æ—Å–º–æ—Ç—Ä–∏–º –ø–æ–≤–ª–∏—è–ª –ª–∏ –Ω–∞ —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–±—Ä–æ—Å –≤ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ä–∞—Å—á–µ—Ç–∞—Ö.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–í—ã–≤–æ–¥ –ø—Ä–∏–Ω—è—Ç!
</div>

### –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º

–ü–æ—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º.
–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ—Ç. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å. –ò –Ω–∞–π–¥—ë–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏.


```python
print('C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º:','{0:.3f}'.format(stats.mannwhitneyu(orders[orders['group']=='A']['revenue'], orders[orders['group']=='B']['revenue'])[1]))
print('–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –í –∏ –ê:','{0:.3f}'.format(orders[orders['group']=='B']['revenue'].mean()/orders[orders['group']=='A']['revenue'].mean()-1)) 
```

    C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´—Å—ã—Ä—ã–º¬ª –¥–∞–Ω–Ω—ã–º: 0.729
    –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –í –∏ –ê: 0.259


***
***–í—ã–≤–æ–¥:*** *P-value 0.729 –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ 0.05. –ó–Ω–∞—á–∏—Ç, –ø—Ä–∏—á–∏–Ω –æ—Ç–≤–µ—Ä–≥–∞—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –∏ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è, –Ω–µ—Ç. –í–ø—Ä–æ—á–µ–º, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B  –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –≥—Ä—É–ø–ø—ã A –Ω–∞ 25,9%. –í–æ–∑–º–æ–∂–Ω–æ –æ–ø—è—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π —Ç–æ–º—É –≤—ã–±—Ä–æ—Å—ã –≤ –¥–∞–Ω—ã—Ö.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞!
</div>

###  –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º

–°–æ—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º. 

–†–∞–Ω–µ–µ –º—ã –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –Ω–µ –±–æ–ª–µ–µ 5% –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏–Ω—Ç—Ä–µ–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –¥–µ–ª–∞–ª–∏ –±–æ–ª–µ–µ –¥–≤—É—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –Ω–µ –±–æ–ª–µ–µ 1% –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –±–æ–ª–µ–µ 4-—Ö –∑–∞–∫–∞–∑–æ–≤. –í—ã–±–µ—Ä–µ–º 4 –∑–∞–∫–∞–∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
 –¢–∞–∫ –∂–µ –Ω–µ –±–æ–ª–µ–µ 5% –ø–æ–∫—É–ø–æ–∫ –≤ –∏–Ω—Ç—Ä–µ–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –±–æ–ª–µ–µ 28000 —Ä—É–±–ª–µ–π –∏ –Ω–µ –±–æ–ª–µ–µ 1% –ø–æ–∫—É–ø–æ–∫ –±–æ–ª–µ–µ 58233.2 —Ä—É–±–ª–µ–π. –í—ã–±–µ—Ä–µ–º 58233.2  –≥—Ä–∞–Ω–∏—Ü–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤.

–°–¥–µ–ª–∞–µ–º —Å—Ä–µ–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —á–∏—Å–ª–æ–º –∑–∞–∫–∞–∑–æ–≤ –±–æ–ª—å—à–µ 4 ‚Äî usersWithManyOrders –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –∑–∞–∫–∞–∑—ã –¥–æ—Ä–æ–∂–µ 58233.2 ‚Äî usersWithExpensiveOrders. –û–±—ä–µ–¥–∏–Ω–∏–º –∏—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ abnormalUsers. 


```python
usersWithManyOrders = pd.concat(
    [
        ordersByUsersA[ordersByUsersA['orders'] > int(np.percentile(ordersByUsers['orders'], [99]))]['visitor_id'],
        ordersByUsersB[ordersByUsersB['orders'] > int(np.percentile(ordersByUsers['orders'], [99]))]['visitor_id'],
    ],
    axis=0,
)
usersWithExpensiveOrders = orders[orders['revenue'] > int(np.percentile(orders['revenue'], [99]))]['visitor_id']
abnormalUsers = (
    pd.concat([usersWithManyOrders, usersWithExpensiveOrders], axis=0)
    .drop_duplicates()
    .sort_values()
)
print('–ö–æ–ª–∏—á–µ—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –±–æ–ª–µ–µ 4 –ø–æ–∫—É–ø–æ–∫ –∏–ª–∏ –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö —Å—É–º–º—É –±–æ–ª–µ–µ 58233.2 —Ä—É–±–ª–µ–π:',abnormalUsers.shape[0])
```

    –ö–æ–ª–∏—á–µ—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –±–æ–ª–µ–µ 4 –ø–æ–∫—É–ø–æ–∫ –∏–ª–∏ –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö —Å—É–º–º—É –±–æ–ª–µ–µ 58233.2 —Ä—É–±–ª–µ–π: 15


<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ú–æ–ª–æ–¥–µ—Ü —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∫–æ–¥ –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–µ–π!
</div>

–ú—ã –ø–æ–ª—É—á–∏–ª–∏ 14 –∞–Ω–æ–º–∞–ª—å–Ω—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫—É—é —Ä–æ–ª—å —Å—ã–≥—Ä–∞–ª–∏ —ç—Ç–∏ –∞–Ω–æ–º–∞–ª–∏ –≤ —Ç–µ—Å—Ç–µ. –ü–æ—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ —Ç–µ—Å—Ç–∞ –ø–æ –æ—á–∏—â–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –≤—ã–±–æ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–µ—Å—Ç–∞.


```python
sampleAFiltered = pd.concat(
    [
        ordersByUsersA[
            np.logical_not(ordersByUsersA['visitor_id'].isin(abnormalUsers))
        ]['orders'],
        pd.Series(
            0,
            index=np.arange(
                visitorsPerDateA['visitors'].sum() - len(ordersByUsersA['orders'])
            ),
            name='orders',
        ),
    ],
    axis=0,
)

sampleBFiltered = pd.concat(
    [
        ordersByUsersB[
            np.logical_not(ordersByUsersB['visitor_id'].isin(abnormalUsers))
        ]['orders'],
        pd.Series(
            0,
            index=np.arange(
                visitorsPerDateB['visitors'].sum() - len(ordersByUsersB['orders'])
            ),
            name='orders',
        ),
    ],
    axis=0,
)
```

–ü—Ä–∏–º–µ–Ω–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∫—Ä–∏—Ç–µ—Ä–∏–π –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –∫ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –≤—ã–±–æ—Ä–∫–∞–º. alpha = 0.05. –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞: —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ—Ç. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è: —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å.


```python
print('C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º:''{0:.3f}'.format(stats.mannwhitneyu(sampleAFiltered, sampleBFiltered)[1]))
print('–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B –∫ –ê:','{0:.3f}'.format(sampleBFiltered.mean()/sampleAFiltered.mean()-1)) 
```

    C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º:0.014
    –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B –∫ –ê: 0.153


***
***–í—ã–≤–æ–¥:*** *–ü–æ –æ—á–∏—â–µ–Ω–Ω—ã–º –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ –¥–∞–Ω–Ω—ã–º P-value 0,014 —Ç–∞–∫–∂–µ –∫–∞–∫ –∏ –ø–æ —Å—ã—Ä—ã–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ 0.05. –ú—ã –∏ —Ç—É—Ç –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É - —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B —É–≤–µ–ª–∏—á–æ–ª–æ—Å—å  - 15,3%.*
***

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

### –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º.

–ü–æ—Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º. 
–ù0: —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ—Ç. 
–ù1: —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å. 


```python
print('C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º:',
    '{0:.3f}'.format(
        stats.mannwhitneyu(
            orders[
                np.logical_and(
                    orders['group'] == 'A',
                    np.logical_not(orders['visitor_id'].isin(abnormalUsers)),
                )
            ]['revenue'],
            orders[
                np.logical_and(
                    orders['group'] == 'B',
                    np.logical_not(orders['visitor_id'].isin(abnormalUsers)),
                )
            ]['revenue'],
        )[1]
    )
)

print('–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –í –∏ –ê:',
    "{0:.3f}".format(
        orders[
            np.logical_and(
                orders['group'] == 'B',
                np.logical_not(orders['visitor_id'].isin(abnormalUsers)),
            )
        ]['revenue'].mean()
        / orders[
            np.logical_and(
                orders['group'] == 'A',
                np.logical_not(orders['visitor_id'].isin(abnormalUsers)),
            )
        ]['revenue'].mean()
        - 1
    )
) 
```

    C—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–∫–∞–∑–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–º¬ª –¥–∞–Ω–Ω—ã–º: 0.851
    –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –í –∏ –ê: -0.006


***
***–í—ã–≤–æ–¥:*** *P-value 0,851 –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ –±–æ–ª—å—à–µ 0.05. –ó–Ω–∞—á–∏—Ç, –ø—Ä–∏—á–∏–Ω –æ—Ç–≤–µ—Ä–≥–∞—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –∏ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è, –Ω–µ—Ç. –í—Ç–æ –∂–µ –≤—Ä–µ–º—è, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B —Å—Ç–∞–ª –Ω–∏–∂–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ê –Ω–∞ 0,6%. –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –≤–µ—Å–æ–º–æ –ø–æ–Ω—è–ª–æ –∫–∞—Ä—Ç–∏–Ω—É –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ.*
***

<div class="alert alert-danger">
    <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–ù–µ —Å–æ–≤—Å–µ–º –≤–µ—Ä–Ω–æ: `–í—Ç–æ –∂–µ –≤—Ä–µ–º—è, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B —Å—Ç–∞–ª –Ω–∏–∂–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ê –Ω–∞ 0,006%` - –∑–Ω–∞—á–µ–Ω–∏–µ `-0.006` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 0.6%. –ü–æ–ø—Ä–∞–≤—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.
</div>

<div class="alert alert-info">
–ü–æ–ø—Ä–∞–≤–∏–ª–∞
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

## –í—ã–≤–æ–¥

***
***–í –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –±—ã–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –ê/–í —Ç–µ—Å—Ç–æ–≤ –∫—Ä—É–ø–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç - –º–∞–≥–∞–∑–∏–Ω–∞.***

*–ü–æ –∏—Ç–æ–≥—É –Ω–∞—à–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–∞–º–∏ ICE RICE –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –¥–≤–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã –ø–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –≤—ã—Ä—É—á–∫–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞:*

***1.***  *–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–∞–∑—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è email-—Ä–∞—Å—Å—ã–ª–æ–∫*

***2.***  *–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–∞ 30% –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π*
    
***–ú—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—à–ª–∏ –≤ –Ω–∏—Ö –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:***

* *–¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏–ª 30 –¥–Ω–µ–π. –° 1 –ø–æ 31 –∞–≤–≥—É—Å—Ç–∞ 2019 –≥–æ–¥–∞*

* *–†–∞–∑–ª–∏—á–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ –±–æ–ª–µ–µ, —á–µ–º 1%.*

* *–û–±–Ω–∞—Ä—É–∂–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã, –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 5,6% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –†–µ—à–∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —Å–º–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –¥–≤—É—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤.*

***–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã A/B-—Ç–µ—Å—Ç–∞:***

*  *–†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –µ—Å—Ç—å. –ü–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º P-value 0,017 , –ø–æ –æ—á–∏—â–µ–Ω–Ω—ã–º - 0,014. –û–±–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ alpha 0,05. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≥—Ä—É–ø–ø—ã B —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å - 15,3% –ø–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º –∏ 13,8%.*


* *–†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–ª–æ—Å—å. –ü–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º P-value 0.729, –ø–æ –æ—á–∏—â–µ–Ω–Ω—ã–º - 0,851. –û–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ 0.05. –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B –ø–æ —Å—ã—Ä—ã–º –¥–∞–Ω–Ω—ã–º –±—ã–ª –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –≥—Ä—É–ø–ø—ã A –Ω–∞ 25,9%. –ê –ø–æ –æ—á–∏—â–µ–Ω–Ω—ã–º -  —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B —Å—Ç–∞–ª –¥–∞–∂–µ –Ω–∏–∂–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ê –Ω–∞ 0,6%. –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö –≤–µ—Å–æ–º–æ –ø–æ–Ω—è–ª–æ –∫–∞—Ä—Ç–∏–Ω—É –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ.*


* *–ü–æ –∏—Ç–æ–≥–∞–º –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç. –ì—Ä—É–ø–ø–∞ –í –ø–æ–±–µ–¥–∏–ª–∞ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å, –∞ –∑–Ω–∞—á–∏—Ç –∏ –≤—ã—Ä—É—á–∫–∞ –≤–æ–∑—Ä–∞—Å–ª–∞.–≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∏ –≥—Ä–∞—Ñ–∏–∫ –∫—É–º–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–∏.*

***

<div class="alert alert-danger">
    <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞:</b>
    
–í —Ü–µ–ª–æ–º, –≤—ã–≤–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, –Ω–æ –∑–¥–µ—Å—å —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0,006% –Ω–∞ 0.6%: `—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≥—Ä—É–ø–ø—ã B —Å—Ç–∞–ª –¥–∞–∂–µ –Ω–∏–∂–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ê –Ω–∞ 0,006%`
</div>

<div class="alert alert-info">
–ò—Å–ø—Ä–∞–≤–∏–ª–∞
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–ü—Ä–∏–Ω—è—Ç–æ!
</div>

<div class="alert alert-success">
    <b>‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ V2:</b>

–ü—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Ç! üéâ
    
–£—Å–ø–µ—Ö–æ–≤ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –æ–±—É—á–µ–Ω–∏–∏!
</div>


```python

```
